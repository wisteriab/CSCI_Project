<!DOCTYPE html>
    <head>
        <style>
            body {
                margin: 0 ;
                font-family:'Times New Roman', Times, serif;
                font-size: 18px;
            }

            .navbar {
                overflow: hidden;
                background-color: darkslategrey;
            }

            .navbar a {
                float: left;
                color: khaki;
                text-align: center;
                font-size: 18 px;
                padding: 28px 28px;
                text-decoration: none;
            }

            .navbar a:hover{
                background-color: khaki;
                color: darkslategrey;
            }

            .navbar a.active{
                background-color: gray;
                color: khaki;
            }

            p {
                text-indent: 50px;
                line-height: 1.2;
                text-align: justify;
            }

            a {
                text-decoration: none;
            }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
            }

        </style>
    </head>
    <body>
        <div class = "navbar">
            <a href ="../index.html">Home</a>
            <a href = "./introduction.html">Introduction</a>
            <a href = "./data_collection_and_scraping.html">Data Exploration</a>
            <a class = "active" href = "./models.html">Models Implemented</a>
            <a href = './conclusions.html'>Conclusions</a>
            <a href = "./Resources.html">Resources</a>
        </div>
        <div style ="margin: 50px 200px 50px">
            <h1>Models Implemented</h1>
            <h2>Further cleaning</h2>
            <p>
                Following preliminary data exploration and cleaning as seen in the data exploration section, further data cleaning was necessary for use in model development.
                Our immediate goal was to eliminate excess columns that contained data irrelevant to the questions at hand and data that was not able to be translated from categorical to ordinal or quantitative.
                The original data after preliminary cleaning, while still maintained both valuable and necessary information was simply too unruly to use in model development.
                Prior to applying these two generic rules, the data looked as follows.
            </p>
            <div>
                <style scoped>
                    .dataframe tbody tr th:only-of-type {
                        vertical-align: middle;
                    }
                
                    .dataframe tbody tr th {
                        vertical-align: top;
                    }
                
                    .dataframe thead th {
                        text-align: right;
                    }
                </style>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th>DAY</th>
                      <th>DEATHS</th>
                      <th>DEFORMEDNAME</th>
                      <th>DR_DRINKNAME</th>
                      <th>DR_HGT</th>
                      <th>DR_PRES</th>
                      <th>DR_PRESNAME</th>
                      <th>DR_WGT</th>
                      <th>DR_ZIP</th>
                      <th>FIRST_MO</th>
                      <th>FIRST_MONAME</th>
                      <th>FIRST_YR</th>
                      <th>FIRST_YRNAME</th>
                      <th>GVWR_FROMNAME</th>
                      <th>GVWR_TONAME</th>
                      <th>HARM_EVNAME</th>
                      <th>HIT_RUNNAME</th>
                      <th>HOUR</th>
                      <th>ICFINALBODYNAME</th>
                      <th>IMPACT1</th>
                      <th>IMPACT1NAME</th>
                      <th>IMPACT2</th>
                      <th>IMPACT2NAME</th>
                      <th>LAST_MO</th>
                      <th>LAST_MONAME</th>
                      <th>LAST_YR</th>
                      <th>LAST_YRNAME</th>
                      <th>L_COMPL</th>
                      <th>L_COMPLNAME</th>
                      <th>L_ENDORS</th>
                      <th>L_ENDORSNAME</th>
                      <th>L_RESTRI</th>
                      <th>L_RESTRINAME</th>
                      <th>L_STATE</th>
                      <th>L_STATENAME</th>
                      <th>L_STATUSNAME</th>
                      <th>L_TYPENAME</th>
                      <th>MAN_COLLNAME</th>
                      <th>MINUTE</th>
                      <th>MINUTENAME</th>
                      <th>MODELNAME</th>
                      <th>MOD_YEAR</th>
                      <th>MONTH</th>
                      <th>MONTHNAME</th>
                      <th>M_HARMNAME</th>
                      <th>NUMOCCS</th>
                      <th>OWNER</th>
                      <th>OWNERNAME</th>
                      <th>PCRASH4NAME</th>
                      <th>PCRASH5NAME</th>
                      <th>P_CRASH1NAME</th>
                      <th>P_CRASH2NAME</th>
                      <th>P_CRASH3NAME</th>
                      <th>REG_STAT</th>
                      <th>REG_STATNAME</th>
                      <th>ROLINLOCNAME</th>
                      <th>SPEEDRELNAME</th>
                      <th>STATE</th>
                      <th>STATENAME</th>
                      <th>ST_CASE</th>
                      <th>TOWEDNAME</th>
                      <th>TOW_VEH</th>
                      <th>TOW_VEHNAME</th>
                      <th>TRAV_SP</th>
                      <th>TRLR1GVWR</th>
                      <th>TRLR1GVWRNAME</th>
                      <th>VIN</th>
                      <th>VNUM_LAN</th>
                      <th>VNUM_LANNAME</th>
                      <th>VPAVETYPNAME</th>
                      <th>VPICBODYCLASSNAME</th>
                      <th>VPICMAKENAME</th>
                      <th>VPICMODELNAME</th>
                      <th>VPROFILENAME</th>
                      <th>VSPD_LIM</th>
                      <th>VSURCONDNAME</th>
                      <th>VTCONT_FNAME</th>
                      <th>VTRAFCONNAME</th>
                      <th>VTRAFWAYNAME</th>
                      <th>V_CONFIGNAME</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>12</td>
                      <td>1</td>
                      <td>Disabling Damage</td>
                      <td>No</td>
                      <td>70.0</td>
                      <td>1</td>
                      <td>Yes</td>
                      <td>NaN</td>
                      <td>33060</td>
                      <td>2</td>
                      <td>February</td>
                      <td>2020</td>
                      <td>2020</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Motor Vehicle In-Transport</td>
                      <td>No</td>
                      <td>22</td>
                      <td>Not Applicable</td>
                      <td>12</td>
                      <td>12 Clock Point</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>4</td>
                      <td>April</td>
                      <td>2020</td>
                      <td>2020</td>
                      <td>2</td>
                      <td>No valid license for this class vehicle</td>
                      <td>0</td>
                      <td>No Endorsements required for this vehicle</td>
                      <td>0</td>
                      <td>No Restrictions or Not Applicable</td>
                      <td>12</td>
                      <td>FL</td>
                      <td>Suspended</td>
                      <td>Full Driver License</td>
                      <td>Front-to-Front</td>
                      <td>10</td>
                      <td>10</td>
                      <td>Patriot</td>
                      <td>2016</td>
                      <td>2</td>
                      <td>February</td>
                      <td>Motor Vehicle In-Transport</td>
                      <td>2</td>
                      <td>1</td>
                      <td>Driver (in this crash) was  Registered Owner</td>
                      <td>Tracking</td>
                      <td>Stayed in original travel lane</td>
                      <td>Going Straight</td>
                      <td>Traveling in opposite direction</td>
                      <td>Unknown/Not Reported</td>
                      <td>12</td>
                      <td>Florida</td>
                      <td>No Rollover</td>
                      <td>No</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>10001</td>
                      <td>Towed Due to Disabling Damage</td>
                      <td>0</td>
                      <td>No Trailing Units</td>
                      <td>85.0</td>
                      <td>77</td>
                      <td>No Trailing Units</td>
                      <td>1C4NJRBB4GD5</td>
                      <td>3</td>
                      <td>Three lanes</td>
                      <td>Blacktop, Bituminous, or Asphalt</td>
                      <td>Sport Utility Vehicle (SUV)/Multi-Purpose Vehi...</td>
                      <td>Jeep</td>
                      <td>Patriot</td>
                      <td>Level</td>
                      <td>70</td>
                      <td>Wet</td>
                      <td>No Controls</td>
                      <td>No Controls</td>
                      <td>Two-Way,  Divided, Positive  Median Barrier</td>
                      <td>Not Applicable</td>
                    </tr>
                    <tr>
                      <td>12</td>
                      <td>1</td>
                      <td>Disabling Damage</td>
                      <td>No</td>
                      <td>NaN</td>
                      <td>1</td>
                      <td>Yes</td>
                      <td>NaN</td>
                      <td>30316</td>
                      <td>0</td>
                      <td>No Record</td>
                      <td>0</td>
                      <td>No Record</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Motor Vehicle In-Transport</td>
                      <td>No</td>
                      <td>22</td>
                      <td>Not Applicable</td>
                      <td>12</td>
                      <td>12 Clock Point</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>0</td>
                      <td>No Record</td>
                      <td>0</td>
                      <td>No Record</td>
                      <td>3</td>
                      <td>Valid license for this class vehicle</td>
                      <td>0</td>
                      <td>No Endorsements required for this vehicle</td>
                      <td>0</td>
                      <td>No Restrictions or Not Applicable</td>
                      <td>13</td>
                      <td>GA</td>
                      <td>Valid</td>
                      <td>Full Driver License</td>
                      <td>Front-to-Front</td>
                      <td>10</td>
                      <td>10</td>
                      <td>XC60 (For 2019 on.  For model years 2008-2018,...</td>
                      <td>2021</td>
                      <td>2</td>
                      <td>February</td>
                      <td>Motor Vehicle In-Transport</td>
                      <td>1</td>
                      <td>1</td>
                      <td>Driver (in this crash) was  Registered Owner</td>
                      <td>Tracking</td>
                      <td>Stayed in original travel lane</td>
                      <td>Going Straight</td>
                      <td>Traveling in opposite direction</td>
                      <td>Unknown/Not Reported</td>
                      <td>13</td>
                      <td>Georgia</td>
                      <td>No Rollover</td>
                      <td>No</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>10001</td>
                      <td>Towed Due to Disabling Damage</td>
                      <td>0</td>
                      <td>No Trailing Units</td>
                      <td>70.0</td>
                      <td>77</td>
                      <td>No Trailing Units</td>
                      <td>YV4102DK2M16</td>
                      <td>3</td>
                      <td>Three lanes</td>
                      <td>Blacktop, Bituminous, or Asphalt</td>
                      <td>Sport Utility Vehicle (SUV)/Multi-Purpose Vehi...</td>
                      <td>Volvo</td>
                      <td>XC60</td>
                      <td>Level</td>
                      <td>70</td>
                      <td>Wet</td>
                      <td>No Controls</td>
                      <td>No Controls</td>
                      <td>Two-Way,  Divided, Positive  Median Barrier</td>
                      <td>Not Applicable</td>
                    </tr>
                    <tr>
                      <td>11</td>
                      <td>2</td>
                      <td>Disabling Damage</td>
                      <td>No</td>
                      <td>65.0</td>
                      <td>1</td>
                      <td>Yes</td>
                      <td>190.0</td>
                      <td>36116</td>
                      <td>1</td>
                      <td>January</td>
                      <td>2020</td>
                      <td>2020</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Concrete Traffic Barrier</td>
                      <td>No</td>
                      <td>18</td>
                      <td>Not Applicable</td>
                      <td>11</td>
                      <td>11 Clock Point</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1</td>
                      <td>January</td>
                      <td>2020</td>
                      <td>2020</td>
                      <td>3</td>
                      <td>Valid license for this class vehicle</td>
                      <td>0</td>
                      <td>No Endorsements required for this vehicle</td>
                      <td>1</td>
                      <td>Restrictions Complied With</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>Valid</td>
                      <td>Full Driver License</td>
                      <td>The First Harmful Event was Not a Collision wi...</td>
                      <td>0</td>
                      <td>0</td>
                      <td>ES-250/300/300h/330/ 350</td>
                      <td>2004</td>
                      <td>2</td>
                      <td>February</td>
                      <td>Utility Pole/Light Support</td>
                      <td>2</td>
                      <td>1</td>
                      <td>Driver (in this crash) was  Registered Owner</td>
                      <td>Precrash stability unknown</td>
                      <td>Departed roadway</td>
                      <td>Going Straight</td>
                      <td>Traveling Too Fast for Conditions or Road Conf...</td>
                      <td>Unknown/Not Reported</td>
                      <td>1</td>
                      <td>Alabama</td>
                      <td>No Rollover</td>
                      <td>Yes, Too Fast for Conditions</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>10002</td>
                      <td>Towed Due to Disabling Damage</td>
                      <td>0</td>
                      <td>No Trailing Units</td>
                      <td>100.0</td>
                      <td>77</td>
                      <td>No Trailing Units</td>
                      <td>JTHBA30G0450</td>
                      <td>3</td>
                      <td>Three lanes</td>
                      <td>Blacktop, Bituminous, or Asphalt</td>
                      <td>Sedan/Saloon</td>
                      <td>Lexus</td>
                      <td>ES</td>
                      <td>Level</td>
                      <td>70</td>
                      <td>Wet</td>
                      <td>No Controls</td>
                      <td>No Controls</td>
                      <td>Two-Way,  Divided, Positive  Median Barrier</td>
                      <td>Not Applicable</td>
                    </tr>
                    <tr>
                      <td>7</td>
                      <td>0</td>
                      <td>Functional Damage</td>
                      <td>No</td>
                      <td>65.0</td>
                      <td>1</td>
                      <td>Yes</td>
                      <td>147.0</td>
                      <td>35405</td>
                      <td>11</td>
                      <td>November</td>
                      <td>2018</td>
                      <td>2018</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Pedestrian</td>
                      <td>No</td>
                      <td>0</td>
                      <td>Not Applicable</td>
                      <td>12</td>
                      <td>12 Clock Point</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>11</td>
                      <td>November</td>
                      <td>2018</td>
                      <td>2018</td>
                      <td>3</td>
                      <td>Valid license for this class vehicle</td>
                      <td>0</td>
                      <td>No Endorsements required for this vehicle</td>
                      <td>0</td>
                      <td>No Restrictions or Not Applicable</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>Valid</td>
                      <td>Full Driver License</td>
                      <td>The First Harmful Event was Not a Collision wi...</td>
                      <td>20</td>
                      <td>20</td>
                      <td>Camry</td>
                      <td>2009</td>
                      <td>2</td>
                      <td>February</td>
                      <td>Pedestrian</td>
                      <td>1</td>
                      <td>2</td>
                      <td>Driver (in this crash) Not Registered Owner (O...</td>
                      <td>Tracking</td>
                      <td>Departed roadway</td>
                      <td>Going Straight</td>
                      <td>Over the lane line on right side of travel lane</td>
                      <td>Unknown/Not Reported</td>
                      <td>1</td>
                      <td>Alabama</td>
                      <td>No Rollover</td>
                      <td>No</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>10003</td>
                      <td>Not Towed</td>
                      <td>0</td>
                      <td>No Trailing Units</td>
                      <td>70.0</td>
                      <td>77</td>
                      <td>No Trailing Units</td>
                      <td>4T1BE46K99U8</td>
                      <td>3</td>
                      <td>Three lanes</td>
                      <td>Concrete</td>
                      <td>Sedan/Saloon</td>
                      <td>Toyota</td>
                      <td>Camry</td>
                      <td>Downhill</td>
                      <td>70</td>
                      <td>Wet</td>
                      <td>No Controls</td>
                      <td>No Controls</td>
                      <td>Two-Way, Divided, Unprotected Median</td>
                      <td>Not Applicable</td>
                    </tr>
                    <tr>
                      <td>3</td>
                      <td>1</td>
                      <td>Disabling Damage</td>
                      <td>No</td>
                      <td>72.0</td>
                      <td>1</td>
                      <td>Yes</td>
                      <td>NaN</td>
                      <td>33127</td>
                      <td>12</td>
                      <td>December</td>
                      <td>2016</td>
                      <td>2016</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Class 1: 6,000 lbs. or less (2,722 kg or less)</td>
                      <td>Ditch</td>
                      <td>No</td>
                      <td>16</td>
                      <td>Not Applicable</td>
                      <td>12</td>
                      <td>12 Clock Point</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>12</td>
                      <td>December</td>
                      <td>2016</td>
                      <td>2016</td>
                      <td>3</td>
                      <td>Valid license for this class vehicle</td>
                      <td>0</td>
                      <td>No Endorsements required for this vehicle</td>
                      <td>0</td>
                      <td>No Restrictions or Not Applicable</td>
                      <td>12</td>
                      <td>FL</td>
                      <td>Valid</td>
                      <td>Full Driver License</td>
                      <td>The First Harmful Event was Not a Collision wi...</td>
                      <td>20</td>
                      <td>20</td>
                      <td>QX60</td>
                      <td>2020</td>
                      <td>2</td>
                      <td>February</td>
                      <td>Tree (Standing Only)</td>
                      <td>1</td>
                      <td>0</td>
                      <td>Not Applicable, Vehicle Not Registered</td>
                      <td>Precrash stability unknown</td>
                      <td>Departed roadway</td>
                      <td>Passing or Overtaking Another Vehicle</td>
                      <td>Off the edge of the road on the right side</td>
                      <td>Unknown/Not Reported</td>
                      <td>12</td>
                      <td>Florida</td>
                      <td>No Rollover</td>
                      <td>No</td>
                      <td>1</td>
                      <td>AL</td>
                      <td>10004</td>
                      <td>Towed Due to Disabling Damage</td>
                      <td>0</td>
                      <td>No Trailing Units</td>
                      <td>NaN</td>
                      <td>77</td>
                      <td>No Trailing Units</td>
                      <td>5N1DL0MN4LC5</td>
                      <td>2</td>
                      <td>Two lanes</td>
                      <td>Blacktop, Bituminous, or Asphalt</td>
                      <td>Sport Utility Vehicle (SUV)/Multi-Purpose Vehi...</td>
                      <td>Infiniti</td>
                      <td>QX60</td>
                      <td>Level</td>
                      <td>70</td>
                      <td>Dry</td>
                      <td>No Controls</td>
                      <td>No Controls</td>
                      <td>Two-Way, Divided, Unprotected Median</td>
                      <td>Not Applicable</td>
                    </tr>
                  </tbody>
                </table>
                </div>
            <p>
                The above table represents the preliminary data table that was used for exploration and general exploratory inquiry.
                As evidenced by both the data and the sheer size of features present most of this was need to be cut.
                Not only is it necessary for use in model production, but helps to make the production of these models more efficient as the dimensionality of the model is decreased.
                With this in mind, a master data table was created to be used amongst the following 4 models.
                It is important to note, however, that not every feature present in this data table is present in each of the models, however, and discretion was used for each one to apply features necessary for the question at hand.
                In this master model dataset, quantitative data was maintained and many of the categorical columns from the dataset above were translated to ordinal data based upon the codes originally applied by the National Highway Traffic Safety Administration.
                The only categorical data kept was of the make and model for use in potential classification by type.
                Model year was also separated into groups of 5 years.
                Said dataset is sampled below:
            </p>
            <div>
              <style scoped>
                  .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                  }
              
                  .dataframe tbody tr th {
                      vertical-align: top;
                  }
              
                  .dataframe thead th {
                      text-align: right;
                  }
              </style>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>DEATHS</th>
                    <th>DR_DRINK</th>
                    <th>DR_HGT</th>
                    <th>DR_WGT</th>
                    <th>HIT_RUNNAME</th>
                    <th>TRAV_SP</th>
                    <th>HOUR</th>
                    <th>MOD_YEAR</th>
                    <th>MODELNAME</th>
                    <th>VSPD_LIM</th>
                    <th>VPICBODYCLASSNAME</th>
                    <th>NUMOCCS</th>
                    <th>MAKENAME</th>
                    <th>MOD_YEAR_5YR_CHUNK</th>
                    <th>DEATHOCCURRED</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>3</td>
                    <td>1</td>
                    <td>67</td>
                    <td>145</td>
                    <td>0</td>
                    <td>80</td>
                    <td>2</td>
                    <td>1997</td>
                    <td>ES-250/300/300h/330/ 350</td>
                    <td>45</td>
                    <td>Sedan/Saloon</td>
                    <td>4</td>
                    <td>Lexus</td>
                    <td>1995</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>67</td>
                    <td>215</td>
                    <td>0</td>
                    <td>70</td>
                    <td>14</td>
                    <td>1995</td>
                    <td>Camry</td>
                    <td>65</td>
                    <td>Sedan/Saloon</td>
                    <td>1</td>
                    <td>Toyota</td>
                    <td>1995</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>73</td>
                    <td>133</td>
                    <td>0</td>
                    <td>80</td>
                    <td>15</td>
                    <td>2007</td>
                    <td>Azera  (For 2018 on, code as vehicle model 398)</td>
                    <td>35</td>
                    <td>Sedan/Saloon</td>
                    <td>5</td>
                    <td>Hyundai</td>
                    <td>2005</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>64</td>
                    <td>115</td>
                    <td>0</td>
                    <td>70</td>
                    <td>0</td>
                    <td>2013</td>
                    <td>Suburban/Yukon XL (2004 on; see 431 for 1950- ...</td>
                    <td>45</td>
                    <td>Sport Utility Vehicle (SUV)/Multi-Purpose Vehi...</td>
                    <td>1</td>
                    <td>GMC</td>
                    <td>2015</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>71</td>
                    <td>185</td>
                    <td>0</td>
                    <td>55</td>
                    <td>16</td>
                    <td>2005</td>
                    <td>Mustang/Mustang II</td>
                    <td>55</td>
                    <td>Coupe</td>
                    <td>1</td>
                    <td>Ford</td>
                    <td>2005</td>
                    <td>1</td>
                  </tr>
                </tbody>
              </table>
              </div>
          <h2>Model Implementation</h2>
          <h3>Support Vector Classification and Linear Support Vector Classification</h3>
            <p>
            Our first models implemented compared sklearn's support vector classification's SVC and linear SVC models to classify the body type of vehicles involved in fatal accidents.
            In order to use these two model types <i>and normalize the data</i> only quantifiable features were allowed to be passed. 
            As such, the above dataset was further modified to one hot encode the make of vehicles present. 
            Furthermore, the deathoccurred column was dropped to prevent multicollinearity and the specific model column was dropped as it passed far too many classifications to be of value.
            As there were multiple dimensions of varying magnitude, this data was first split into a training and test set and immediately normalized such that the difference in magnitudes did not favor some features over others.
            Normalizing the data after splitting in this way prevented data leakage from occurring while still enabling a way for standardization to occur.
            The final trained does not include the target column VPICBODYCLASSNAME which is the body style of the vehicles present. 
            7 body type classes targetted are Sedan/Saloon, SUV, Pickup, Motorcycle, Coupe, Hatchback, and Minivan.
            Said training dataset looks as follows prior to normalization:
            </p>
            <div>
              <style scoped>
                  .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                  }
              
                  .dataframe tbody tr th {
                      vertical-align: top;
                  }
              
                  .dataframe thead th {
                      text-align: right;
                  }
              </style>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>DEATHS</th>
                    <th>DR_DRINK</th>
                    <th>DR_HGT</th>
                    <th>DR_WGT</th>
                    <th>HIT_RUNNAME</th>
                    <th>TRAV_SP</th>
                    <th>HOUR</th>
                    <th>MOD_YEAR</th>
                    <th>VSPD_LIM</th>
                    <th>NUMOCCS</th>
                    <th>MOD_YEAR_5YR_CHUNK</th>
                    <th>MAKENAME_AM General</th>
                    <th>MAKENAME_Acura</th>
                    <th>MAKENAME_Audi</th>
                    <th>MAKENAME_BMW</th>
                    <th>MAKENAME_Buick / Opel</th>
                    <th>MAKENAME_Cadillac</th>
                    <th>MAKENAME_Chevrolet</th>
                    <th>MAKENAME_Chrysler</th>
                    <th>MAKENAME_Dodge</th>
                    <th>MAKENAME_Ducati</th>
                    <th>MAKENAME_Fiat</th>
                    <th>MAKENAME_Ford</th>
                    <th>MAKENAME_GMC</th>
                    <th>MAKENAME_Harley-Davidson</th>
                    <th>MAKENAME_Honda</th>
                    <th>MAKENAME_Hyundai</th>
                    <th>MAKENAME_Infiniti</th>
                    <th>MAKENAME_Isuzu</th>
                    <th>MAKENAME_Jaguar</th>
                    <th>MAKENAME_Jeep / Kaiser-Jeep / Willys- Jeep</th>
                    <th>MAKENAME_KIA</th>
                    <th>MAKENAME_Kawasaki</th>
                    <th>MAKENAME_Land Rover</th>
                    <th>MAKENAME_Lexus</th>
                    <th>MAKENAME_Lincoln</th>
                    <th>MAKENAME_Mazda</th>
                    <th>MAKENAME_Mercedes-Benz</th>
                    <th>MAKENAME_Mercury</th>
                    <th>MAKENAME_Mitsubishi</th>
                    <th>MAKENAME_Nissan/Datsun</th>
                    <th>MAKENAME_Oldsmobile</th>
                    <th>MAKENAME_Pontiac</th>
                    <th>MAKENAME_Porsche</th>
                    <th>MAKENAME_Saab</th>
                    <th>MAKENAME_Saturn</th>
                    <th>MAKENAME_Scion</th>
                    <th>MAKENAME_Subaru</th>
                    <th>MAKENAME_Suzuki</th>
                    <th>MAKENAME_Toyota</th>
                    <th>MAKENAME_Triumph</th>
                    <th>MAKENAME_Victory</th>
                    <th>MAKENAME_Volkswagen</th>
                    <th>MAKENAME_Volvo</th>
                    <th>MAKENAME_Yamaha</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>3</td>
                    <td>1</td>
                    <td>67</td>
                    <td>145</td>
                    <td>0</td>
                    <td>80</td>
                    <td>2</td>
                    <td>1997</td>
                    <td>45</td>
                    <td>4</td>
                    <td>1995</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>67</td>
                    <td>215</td>
                    <td>0</td>
                    <td>70</td>
                    <td>14</td>
                    <td>1995</td>
                    <td>65</td>
                    <td>1</td>
                    <td>1995</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>73</td>
                    <td>133</td>
                    <td>0</td>
                    <td>80</td>
                    <td>15</td>
                    <td>2007</td>
                    <td>35</td>
                    <td>5</td>
                    <td>2005</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>64</td>
                    <td>115</td>
                    <td>0</td>
                    <td>70</td>
                    <td>0</td>
                    <td>2013</td>
                    <td>45</td>
                    <td>1</td>
                    <td>2015</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>71</td>
                    <td>185</td>
                    <td>0</td>
                    <td>55</td>
                    <td>16</td>
                    <td>2005</td>
                    <td>55</td>
                    <td>1</td>
                    <td>2005</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                </tbody>
              </table>
              </div>
            <p>
              Considering the high dimensionality in the above dataset, another set of the same two models were implemented on a reduced version of the dataset that excluded any information on the make type.
              This ultimately reduced the net number of features (according to the model) from 55 to 11 as the one-hot-encoded car model types were now eliminated.
              Following fitting and implementing these 4 models on the training data, they were then tested according to the accuracy, recall, precision and f1 scores to compare effectiveness of the model in classifying vehicle types present in a fatal accident.
              These scores are included below:
            </p>
            <div>
              <style scoped>
                  .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                  }
              
                  .dataframe tbody tr th {
                      vertical-align: top;
                  }
              
                  .dataframe thead th {
                      text-align: right;
                  }
              </style>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>Model Type</th>
                    <th>Accuracy Score</th>
                    <th>Precision Score</th>
                    <th>Recall Score</th>
                    <th>F1 Score</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>SVC</td>
                    <td>2533.0</td>
                    <td>0.558209</td>
                    <td>0.579501</td>
                    <td>0.538466</td>
                  </tr>
                  <tr>
                    <td>Linear SVC</td>
                    <td>2538.0</td>
                    <td>0.569897</td>
                    <td>0.580645</td>
                    <td>0.536464</td>
                  </tr>
                  <tr>
                    <td>Reduced SVC</td>
                    <td>1541.0</td>
                    <td>0.230243</td>
                    <td>0.352551</td>
                    <td>0.247562</td>
                  </tr>
                  <tr>
                    <td>Reduced Linear SVC</td>
                    <td>1578.0</td>
                    <td>0.321388</td>
                    <td>0.361016</td>
                    <td>0.290559</td>
                  </tr>
                </tbody>
              </table>
              </div>
            <p>
              It is additionally important to note that when calculating these scores, the weighted average of the scores were included such that the support of classes were taken into account.
              This came as a necessity as the goal of this model was a multiclass prediction. As such the weighted, micro or macro scores were necessary.
              The weighted score was chosen over the other two due to the difference in volumes of each target class present.
              Looking to the accuracy scores of these 4 models, accuracy, recall, f1 and precision, we can see the highest performer, the linear SVC model of the full dataset, was able to answer the question of whether these features could predict what body class was present in a fatal accident with shy of 60% accuracy.
              While this result is not the greatest at perfect prediction, the results of each of the scores provide insight into the data itself.
              We see that there is a greater difference between the linear and svc models in the reduced dataset than the full dataset.
              In both sets of comparisons in classification, the linear SVC models outperformed the plain SVC model ever so slightly ultimately suggesting its superiority in this situation.
              Surprisingly too, the reduced model faired substantially poorer than the non-reduced model scoreing nearly half of the full model.
              Ultimately this suggests that the make of the car is a highly important feature when attempting to classify what class of vehicle was present in a fatal accident.
              
            </p>
          <h3>Random Forest Classification</h3>
            <p>
              In addition to the Support vector classification and the linear support vector classification, there are other modalities to test the data.
              With this in mind, the master dataset above was modified for another question of interest: can the data in the dataset be used to predict whether a fatality occured in a given accident.
              In order to do this, the dataset was again modified with a boolean value to represent whether a death had occurred or not. 
              The dataset looks as follows and is used in the following 3 models:
            </p>
            <div>
              <style scoped>
                  .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                  }
              
                  .dataframe tbody tr th {
                      vertical-align: top;
                  }
              
                  .dataframe thead th {
                      text-align: right;
                  }
              </style>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>DEATHS</th>
                    <th>DR_DRINK</th>
                    <th>DR_HGT</th>
                    <th>DR_WGT</th>
                    <th>HIT_RUNNAME</th>
                    <th>TRAV_SP</th>
                    <th>HOUR</th>
                    <th>MOD_YEAR</th>
                    <th>MODELNAME</th>
                    <th>VSPD_LIM</th>
                    <th>VPICBODYCLASSNAME</th>
                    <th>NUMOCCS</th>
                    <th>MAKENAME</th>
                    <th>MINUTE</th>
                    <th>TIME</th>
                    <th>APRX_WGT</th>
                    <th>MOD_YEAR_5YR_CHUNK</th>
                    <th>RELATIVE_SPEED</th>
                    <th>BMI</th>
                    <th>DEATHOCCURRED</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>3</td>
                    <td>1</td>
                    <td>67</td>
                    <td>145</td>
                    <td>0</td>
                    <td>80</td>
                    <td>2</td>
                    <td>1997</td>
                    <td>ES-250/300/300h/330/ 350</td>
                    <td>45</td>
                    <td>Sedan/Saloon</td>
                    <td>4</td>
                    <td>Lexus</td>
                    <td>58</td>
                    <td>2.966667</td>
                    <td>3282.602226</td>
                    <td>1995</td>
                    <td>35</td>
                    <td>22.707730</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>67</td>
                    <td>215</td>
                    <td>0</td>
                    <td>70</td>
                    <td>14</td>
                    <td>1995</td>
                    <td>Camry</td>
                    <td>65</td>
                    <td>Sedan/Saloon</td>
                    <td>1</td>
                    <td>Toyota</td>
                    <td>55</td>
                    <td>14.916667</td>
                    <td>3491.123366</td>
                    <td>1995</td>
                    <td>5</td>
                    <td>33.670082</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>0</td>
                    <td>0</td>
                    <td>68</td>
                    <td>228</td>
                    <td>0</td>
                    <td>10</td>
                    <td>14</td>
                    <td>2016</td>
                    <td>Medium/Heavy - CBE</td>
                    <td>55</td>
                    <td>Truck-Tractor</td>
                    <td>1</td>
                    <td>Peterbilt</td>
                    <td>55</td>
                    <td>14.916667</td>
                    <td>20496.736917</td>
                    <td>2015</td>
                    <td>-45</td>
                    <td>34.663495</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>73</td>
                    <td>133</td>
                    <td>0</td>
                    <td>80</td>
                    <td>15</td>
                    <td>2007</td>
                    <td>Azera  (For 2018 on, code as vehicle model 398)</td>
                    <td>35</td>
                    <td>Sedan/Saloon</td>
                    <td>5</td>
                    <td>Hyundai</td>
                    <td>20</td>
                    <td>15.333333</td>
                    <td>2755.457278</td>
                    <td>2005</td>
                    <td>45</td>
                    <td>17.545318</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>64</td>
                    <td>115</td>
                    <td>0</td>
                    <td>70</td>
                    <td>0</td>
                    <td>2013</td>
                    <td>Suburban/Yukon XL (2004 on; see 431 for 1950- ...</td>
                    <td>45</td>
                    <td>Sport Utility Vehicle (SUV)/Multi-Purpose Vehi...</td>
                    <td>1</td>
                    <td>GMC</td>
                    <td>45</td>
                    <td>0.750000</td>
                    <td>4115.627711</td>
                    <td>2015</td>
                    <td>25</td>
                    <td>19.737549</td>
                    <td>1</td>
                  </tr>
                </tbody>
              </table>
              </div>
            <p>
              This data was then applied to a random forest classifier in an attempt to optimize prediction to the previous question.
              Random forest classification in general averages multiple decision trees such that overfitting is more corrected for, and provide insight into the importance of features in the data.
              Following implementation of the model on the above dataset, the random forest classifier was able to answer that yes, we can predict whether a death occurred in a given vehicle with an accuracy of roughly 75% as seen in the table below:
            </p>
              <div>
                <style scoped>
                    .dataframe tbody tr th:only-of-type {
                        vertical-align: middle;
                    }
                
                    .dataframe tbody tr th {
                        vertical-align: top;
                    }
                
                    .dataframe thead th {
                        text-align: right;
                    }
                </style>
                <table border="1" class="dataframe">
                  <thead>
                    <tr style="text-align: right;">
                      <th>Accuracy</th>
                      <th>Precision</th>
                      <th>Recall</th>
                      <th>F1 Score</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>0.748418</td>
                      <td>0.76768</td>
                      <td>0.71223</td>
                      <td>0.738916</td>
                    </tr>
                  </tbody>
                </table>
                </div>
            <p>
              It is also worth noting that when the data was again refined to include only those points where the driver was intoxicated, the score of the model increased with accuracy, recall, f1 and precision scores of 0.814, 0.984, 0.894, and 0.819 respectively.
              The random forest classifier additionally ranked the features in the dataset from most to least important:
              <ol>
                <li>Approximate weight</li>
                <li>Relative speed</li>
                <li>Model year</li>
                <li>Time</li>
                <li>Travel speed</li>
                <li>BMI</li>
                <li>Minute</li>
                <li>Driver weight</li>
                <li>Driver intoxication</li>
                <li>Driver height</li>
                <li>Hour</li>
                <li>Speed limit</li>
                <li>Number of vehicle occupants</li>
                <li>Whether the accident was a hit and run or not</li>
              </ol>
              Using this information provides some insight into whether each of these features is necessary and how much value it has to the model. 
              In order to reduce these features optimally, we can either use backwards selection, or implement another model to optimize the features present.
              Said model is Principal Component Analysis and follows in the next section.
            </p>
          <h3>Principal Component Analysis</h3>
            <p>
              Looking to the random forest classifier, it is evident that the data is highly dimensional. 
              While backwards selection is an option, we can optimize dimension reduction through Principal Component Analysis as previously mentioned.
              PCA will also help to answer whether it is even possible or wise to reduce the dimensionality of the dataset. 
              After implementation of PCA, results demonstrated that it is possible to reduce the dimensions of the dataset, although successive reduction in data did not wholely reduce noise all that dramatically.
              As seen in the below graph, successful clustering of the data into vehicles with a death present and those without demonstrates that there are evident groups among the data.
              The locii of each of the two groups is distinct from one another.
              However, as seen by the combination of the two groups in the middle, there is substanital muddling and a lack of a clear hyperplane that could seaprate and cluster the two groups nicely.
            </p>
              <figure>
                <img src = "../plots/PCA.png"  style = "float:center"> 
              </figure>    
          <h3>K Means Clustering</h3>
            <p>
              Following moderate success in testing whether dimensionality could occur, further models can be implemented to see if clustering is an effective way to predict whether a death occurred or not.
              Looking to the Principal Component Analysis and the output it provided, K means clustering with a k value of 2 is likely to be a successful choice as evidenced by the 2 distinct locii as seen above.
              In general K means clustering aims to group all points within a dataset into k groups. 
              The rules used to cluster each observation are then applied to the test set to validate teh models efficacy.
              Implementation of K means clustering yielded a grouping of points as seen in the image below.
              Ultimately, this grouping is more decisive than the PCA grouping although there is still muddled overlap present in the data.
            </p>
              <figure>
                <img src = "../plots/KMeans.png" style = "float:center">
              </figure>
            <p>
              Furthermore, the accuracy scores of the clustering model were as follows:
            </p>
            <div>
              <style scoped>
                  .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                  }
              
                  .dataframe tbody tr th {
                      vertical-align: top;
                  }
              
                  .dataframe thead th {
                      text-align: right;
                  }
              </style>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>Accuracy</th>
                    <th>Precision</th>
                    <th>Recall</th>
                    <th>F1 Score</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>0.664797</td>
                    <td>0.663359</td>
                    <td>0.661458</td>
                    <td>0.662407</td>
                  </tr>
                </tbody>
              </table>
              </div>
            <p>
              These scores indicate that this model of clustering was susbstantially better than any of the 4 SVC models highlighting the efficacy of the PCA model implemented above.
              However, a score averaging 66% still isn't ideal ultimately suggesting that a more dynamic model like the random forest classifier may be best for a highly dimensional, noisy dataset as this one.
            </p>
          <h3>Drawbacks in Model Development</h3>
          <p>
            While working through this dataset and implementing each of our models, many setbacks impacted successful model development.
            The most immediate issue arose during the second round of data cleaning.
            Much of the data collected by the National Highway Traffic Administration is categorical or ordinal. 
            The categorical data had to be remapped in some cases to ordinal data to represent certain categories. 
            This ultimately has drawbacks in that it may favor certain categories or groups based on the value it is assigned.
            In the case where such data was one hot encoded, it made the data set highly dimensional which likely reduced the suceess of the model as seen by the low scores of each of the SVC models.
            While translating categorical and remapping some of the ordinal data, attempts were made to fairly distribute values to certain categories, although it is likely that due to the nature of how models are trained and developed, some bias will exist.
            This brings about a further issue seen in the data: the lack of normality in some of the features.
            The lack of normality amongst the terms impacted the importance of some features and presented another avenue for bias.
            This was minimized weherever possible by standardizing and scaling variables and eliminating outliers when possible.
          </p>
          <p>
            Additionally, the data was highly dimensional.
            As seen by many of the datasets used, many of the datasets used had a noticeable amount of features. 
            This was a substantial reduction in features from the original dataset, however, such high dimensionality has the potential to lead to issues with multicollinearity adn overexplanation by the models.
            Attempts were made to reduce the impact of such features by preemptively reducing the amount of features present logically.
            However, as with the ordinal data, there is potential for some bias to exist in the same manner as bias seen in the newly created and mapped ordinal features.
          </p>
        </div>
    </body>
</html>